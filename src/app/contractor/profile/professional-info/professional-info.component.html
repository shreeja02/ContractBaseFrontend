<ion-grid>
  <ion-row>
    <ion-col size="12">
      <ion-card class="form-card">
        <ion-card-header class="card-header">
          <h2>Professional Details</h2>
          <p>Complete your professional information</p>
        </ion-card-header>
        <ion-card-content class="form-section">
          <div>
            <form [formGroup]="form">
              <div class="form-row">
                <div class="form-col">
                  <div class="form-group">
                    <ion-input formControlName="yearsOfExperience" type="number" label="Years of Experience*"
                      label-placement="floating" fill="outline" placeholder="Enter years"></ion-input>
                    <div class="error-message"
                      *ngIf="form.get('yearsOfExperience')?.invalid && form.get('yearsOfExperience')?.touched">
                      <span *ngIf="form.get('yearsOfExperience')?.errors?.required">Experience is required</span>
                      <span *ngIf="form.get('yearsOfExperience')?.errors?.min">Experience must be greater than 0</span>
                    </div>
                  </div>
                </div>
                <div class="form-col">
                  <div class="form-group">
                    <ion-input formControlName="hourlyRate" type="number" label="Hourly Rate (CAD)*"
                      label-placement="floating" fill="outline" placeholder="Enter rate"></ion-input>
                    <div class="error-message"
                      *ngIf="form.get('hourlyRate')?.invalid && form.get('hourlyRate')?.touched">
                      <span *ngIf="form.get('hourlyRate')?.errors?.required">Hourly Rate is required</span>
                      <span *ngIf="form.get('hourlyRate')?.errors?.min">Rate must be greater than 0</span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-col">
                  <div class="form-group">
                    <label class="form-label">Project Budget*</label>
                    <ion-select formControlName="projectBudget" interface="popover" fill="outline"
                      placeholder="Please select Project Budget" [multiple]="true">
                      <ion-select-option *ngFor="let item of projectBudget" [value]="item">{{item}}</ion-select-option>
                    </ion-select>
                    <div class="error-message"
                      *ngIf="form.get('projectBudget')?.invalid && form.get('projectBudget')?.touched">
                      Selection of Project Budget is required
                    </div>
                  </div>
                </div>
                <div class="form-col">
                  <div class="form-group">
                    <label class="form-label">Team Size*</label>
                    <ion-select formControlName="teamSize" interface="popover" fill="outline"
                      placeholder="Please select Team Size" [multiple]="true">
                      <ion-select-option *ngFor="let item of teamSize" [value]="item">{{item}}</ion-select-option>
                    </ion-select>
                    <div class="error-message"
                      *ngIf="form.get('teamSize')?.invalid && form.get('teamSize')?.touched">
                      Selection of Team Size is required
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-col">
                  <div class="form-group">
                    <label class="form-label">Location Preference*</label>
                    <ion-select formControlName="location" (ionChange)="handleChange($event)" interface="popover"
                      fill="outline" placeholder="Select location preferences" [multiple]="true"
                      [compareWith]="compareLocationObjects">
                      <ion-select-option *ngFor="let item of allLocations" [value]="item">{{item.type}}</ion-select-option>
                    </ion-select>
                  </div>
                </div>
                <div class="form-col" *ngIf="isHybridSelected">
                  <div class="form-group">
                    <label class="form-label">Days in the office*</label>
                    <ion-input formControlName="hybridDays" type="number"
                      label="Days in Office (for Hybrid)*" label-placement="floating"
                      fill="outline" placeholder="Enter number of days (0-5)"></ion-input>
                    <div class="error-message"
                      *ngIf="form.get('hybridDays')?.invalid && form.get('hybridDays')?.touched">
                      <span *ngIf="form.get('hybridDays')?.errors?.min">Days must be at least 0</span>
                      <span *ngIf="form.get('hybridDays')?.errors?.max">Days cannot exceed 5</span>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-col">
                  <div class="form-group">
                    <label class="form-label">Contract Length*</label>
                    <ion-select formControlName="contractLength" interface="popover" fill="outline"
                      placeholder="Please select Contract Length" [multiple]="true">
                      <ion-select-option *ngFor="let item of contractLength" [value]="item">{{item}}</ion-select-option>
                    </ion-select>
                    <div class="error-message"
                      *ngIf="form.get('contractLength')?.invalid && form.get('contractLength')?.touched">
                      Selection of Contract Length is required
                    </div>
                  </div>
                </div>
                <div class="form-col">
                  <div class="form-group">
                    <label class="form-label">Available Date*</label>
                    <mat-form-field class="mat-form-field-full">
                      <mat-label>Available Date</mat-label>
                      <input formControlName="availableDate" [min]="todayDate" matInput
                        [matDatepicker]="picker">
                      <mat-hint>MM/DD/YYYY</mat-hint>
                      <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                      <mat-datepicker #picker disabled="false"></mat-datepicker>
                    </mat-form-field>
                    <div class="error-message"
                      *ngIf="form.get('availableDate')?.invalid && form.get('availableDate')?.touched">
                      Selection of Available Date is required
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </ion-card-content>
        <div class="button-section">
          <ion-button fill="outline" (click)="previous()" [disabled]="isLoading">
            <ion-icon slot="start" name="arrow-back-outline"></ion-icon>
            Previous
          </ion-button>
          <ion-button (click)="save()" [disabled]="isLoading">
            <span *ngIf="!isLoading">
              <ion-icon slot="start" name="checkmark-circle-outline"></ion-icon>
              Complete Profile
            </span>
            <span *ngIf="isLoading">
              <ion-spinner name="crescent"></ion-spinner>
              Saving...
            </span>
          </ion-button>
        </div>
      </ion-card>
    </ion-col>
  </ion-row>
</ion-grid>