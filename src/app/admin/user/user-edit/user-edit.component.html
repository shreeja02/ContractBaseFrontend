<form [formGroup]="userForm">
  <div>
    <ion-grid>
      <ion-row>
        <ion-col>

          <div class="page-header d-flex-center">
            <h1 *ngIf="isEdit">EDIT USER</h1>
            <h1 *ngIf="!isEdit">ADD NEW USER</h1>
          </div>
          <ion-grid>
            <ion-row>
              <ion-col>
                <div class="d-flex-column w-100">
                  <ion-input formControlName="firstName" type="text" label="First Name*" label-placement="floating"
                    fill="outline"></ion-input>

                  <div class="ml-2 mt-2"
                    *ngIf="userForm.controls['firstName']?.invalid && (userForm.controls['firstName']?.dirty || userForm.controls['firstName'].touched)">
                    <div class="error-class" *ngIf="userForm.controls['firstName']?.errors?.required">
                      User First Name is required.
                    </div>
                  </div>
                </div>
              </ion-col>
              <ion-col>
                <div class="d-flex-column">
                  <ion-input formControlName="lastName" type="text" label="Last Name*" label-placement="floating"
                    fill="outline"></ion-input>
                  <div class="ml-2 mt-2"
                    *ngIf="userForm.controls['lastName']?.invalid && (userForm.controls['lastName']?.dirty || userForm.controls['lastName'].touched)">
                    <div class="error-class" *ngIf="userForm.controls['lastName']?.errors?.required">
                      User Last Name is required.
                    </div>
                  </div>
                </div>
              </ion-col>
            </ion-row>

            <ion-row>
              <ion-col>
                <div class="d-flex-column">
                  <ion-input formControlName="email" type="text" label="Email*" label-placement="floating"
                    fill="outline"></ion-input>

                  <div class="ml-2 mt-2"
                    *ngIf="userForm.controls['email']?.invalid && (userForm.controls['email']?.dirty || userForm.controls['email'].touched)">
                    <div class="error-class" *ngIf="userForm.controls['email']?.errors?.required">
                      Email Address is required.
                    </div>
                    <div class="error-class" *ngIf="userForm.controls['email']?.hasError('pattern')">
                      Email Address is invalid.
                    </div>
                  </div>
                </div>
              </ion-col>
            </ion-row>

            <ion-row>
              <ion-col>
                <div class="d-flex-column">
                  <ion-input formControlName="phone" type="text" label="Phone*" label-placement="floating"
                    fill="outline"></ion-input>
                  <div class="ml-2 mt-2"
                    *ngIf="userForm.controls['phone']?.invalid && (userForm.controls['phone']?.dirty || userForm.controls['phone'].touched)">
                    <div class="error-class" *ngIf="userForm.controls['phone']?.hasError('required')">
                      Phone Number is required.
                    </div>
                    <div class="error-class" *ngIf="userForm.controls['phone']?.hasError('minLength')">
                      Phone Number should be 10 digits long.
                    </div>
                    <div class="error-class" *ngIf="userForm.controls['phone']?.hasError('maxLength')">
                      Phone Number should be 10 digits long.
                    </div>
                    <div class="error-class" *ngIf="userForm.controls['phone']?.hasError('pattern')">
                      Phone Number is in wrong format.
                    </div>
                  </div>
                </div>
              </ion-col>
              <ion-col>
                <div class="d-flex-column">
                  <ion-select (ionChange)="handleChangeForProvince($event)" fill="outline" formControlName="provinceId"
                    interface="popover" placeholder="Provinces">
                    <ion-select-option *ngFor="let item of allProvinces"
                      [value]="item._id">{{item.provinceName}}</ion-select-option>
                  </ion-select>

                  <div class="ml-2 mt-2"
                    *ngIf="userForm.controls['provinceId']?.invalid && (userForm.controls['provinceId']?.dirty || userForm.controls['provinceId'].touched)">
                    <div class="error-class" *ngIf="userForm.controls['provinceId']?.errors?.required">
                      Province is required.
                    </div>
                  </div>
                </div>
              </ion-col>
            </ion-row>

            <ion-row>
              <ion-col>
                <div class="d-flex-column">
                  <ion-select class="w-100" fill="outline" formControlName="cityId" interface="popover"
                    placeholder="City">
                    <ion-select-option *ngFor="let item of allCities"
                      [value]="item._id">{{item.cityName}}</ion-select-option>
                  </ion-select>
                  <div class="ml-2 mt-2"
                    *ngIf="userForm.controls['cityId']?.invalid && (userForm.controls['cityId']?.dirty || userForm.controls['cityId'].touched)">
                    <div class="error-class" *ngIf="userForm.controls['cityId']?.errors?.required">
                      City is required.
                    </div>
                  </div>
                </div>
              </ion-col>
              <ion-col>
                <div class="d-flex-column">
                  <ion-select fill="outline" formControlName="roleId" interface="popover" placeholder="Role">
                    <ion-select-option *ngFor="let item of allRoles"
                      [value]="item._id">{{item.roleName}}</ion-select-option>
                  </ion-select>
                  <div class="ml-2 mt-2"
                    *ngIf="userForm.controls['roleId']?.invalid && (userForm.controls['roleId']?.dirty || userForm.controls['roleId'].touched)">
                    <div class="error-class" *ngIf="userForm.controls['roleId']?.errors?.required">
                      Role is required.
                    </div>
                  </div>
                </div>
              </ion-col>
            </ion-row>
          </ion-grid>
          <div class="ml-3 mt-3">
            <ion-checkbox formControlName="isActive" justify="end">Active</ion-checkbox>
          </div>
          <div class="d-flex-end p-4">
            <ion-button (click)="onBack()">Back</ion-button>
            <ion-button (click)="onSave()">Save</ion-button>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
</form>