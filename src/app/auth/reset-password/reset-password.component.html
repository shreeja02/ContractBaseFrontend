<div class="reset-container">
  <ion-grid class="reset-grid">
    <ion-row>
      <ion-col sizeLg="6" sizeMd="8" sizeSm="12" class="reset-col-wrapper">
        <ion-card class="reset-card" *ngIf="!errorMessage || token" [formGroup]="resetPasswordForm">
          <!-- Header Section -->
          <div class="reset-header">
            <div class="logo-container">
              <img class="reset-logo" src="../../../assets/images/top3talent-logo.png" alt="Logo">
            </div>
            <h1 class="reset-title">Reset Password</h1>
            <p class="reset-subtitle">Create a new password for your account</p>
          </div>

          <ion-card-content class="reset-form-content">
            <!-- Password Section -->
            <div class="form-section">
              <div class="form-field-wrapper">
                <ion-input 
                  [type]="isPasswordHidden ? 'password' : 'text'" 
                  formControlName="password" 
                  label="New Password" 
                  label-placement="floating" 
                  fill="outline"
                  placeholder="••••••••••••"
                  class="form-input"
                  [class.input-error]="resetPasswordForm.controls['password']?.invalid && (resetPasswordForm.controls['password']?.dirty || resetPasswordForm.controls['password'].touched)">
                  <ion-button 
                    fill="clear" 
                    slot="end" 
                    (click)="isPasswordHidden=!isPasswordHidden"
                    class="password-toggle">
                    <ion-icon 
                      slot="icon-only" 
                      [name]="isPasswordHidden ? 'eye-outline' : 'eye-off-outline'">
                    </ion-icon>
                  </ion-button>
                </ion-input>
                <div class="password-hint">
                  <p><strong>Password Requirements:</strong></p>
                  <ul>
                    <!-- <li [class.met]="resetPasswordForm.controls['password']?.value?.length >= 8">At least 8 characters</li>
                    <li [class.met]="/[A-Z]/.test(resetPasswordForm.controls['password']?.value)">One uppercase letter (A-Z)</li>
                    <li [class.met]="/[a-z]/.test(resetPasswordForm.controls['password']?.value)">One lowercase letter (a-z)</li>
                    <li [class.met]="/[0-9]/.test(resetPasswordForm.controls['password']?.value)">One number (0-9)</li> -->
                    <!-- <li [class.met]="`/[!@#$%^&*()_+\-=\[\]{};':\"\\|,.<>\/?]/.test(resetPasswordForm.controls['password']?.value)">One special character (!@#$%)</li> -->
                  </ul>
                </div>
                <div class="error-message"
                  *ngIf="resetPasswordForm.controls['password']?.invalid && (resetPasswordForm.controls['password']?.dirty || resetPasswordForm.controls['password'].touched)">
                  <ion-icon name="alert-circle-outline"></ion-icon>
                  <span *ngIf="resetPasswordForm.controls['password']?.errors?.required">Password is required</span>
                  <span *ngIf="resetPasswordForm.controls['password']?.errors?.minlength">Password must be at least 8 characters</span>
                  <span *ngIf="resetPasswordForm.controls['password']?.errors?.pattern">Password does not meet requirements</span>
                </div>
              </div>

              <div class="form-field-wrapper">
                <ion-input 
                  type="password" 
                  formControlName="confirmPassword" 
                  label="Confirm Password" 
                  label-placement="floating" 
                  fill="outline"
                  placeholder="••••••••••••"
                  class="form-input"
                  [class.input-error]="resetPasswordForm.get('confirmPassword')?.touched && resetPasswordForm.get('confirmPassword')?.invalid">
                  <ion-button 
                    fill="clear" 
                    slot="end" 
                    (click)="isConfirmPasswordHidden=!isConfirmPasswordHidden"
                    class="password-toggle">
                    <ion-icon 
                      slot="icon-only" 
                      [name]="isConfirmPasswordHidden ? 'eye-outline' : 'eye-off-outline'">
                    </ion-icon>
                  </ion-button>
                </ion-input>
                <div class="error-message"
                  *ngIf="resetPasswordForm.get('confirmPassword')?.touched && resetPasswordForm.get('confirmPassword')?.invalid">
                  <ion-icon name="alert-circle-outline"></ion-icon>
                  <span *ngIf="resetPasswordForm.get('confirmPassword')?.errors?.['required']">Please confirm your password</span>
                  <span *ngIf="resetPasswordForm.errors?.['mismatch']">Passwords do not match</span>
                </div>
              </div>

              <!-- Error Message -->
              <div class="error-alert" *ngIf="errorMessage">
                <ion-icon name="alert-circle-outline"></ion-icon>
                <span>{{ errorMessage }}</span>
              </div>
            </div>
          </ion-card-content>

          <!-- Action Buttons -->
          <div class="reset-actions">
            <ion-button 
              expand="block" 
              (click)="onSubmit()"
              class="reset-button"
              [disabled]="resetPasswordForm.invalid || loading">
              <ion-spinner *ngIf="loading" class="button-spinner"></ion-spinner>
              <span *ngIf="!loading">Reset Password</span>
            </ion-button>
          </div>

          <!-- Back to Login Link -->
          <div class="back-link-section">
            <a [routerLink]="['/auth/login']" class="back-link">
              <ion-text color="primary">
                <ion-icon name="chevron-back-outline"></ion-icon>
                <span>Back to Login</span>
              </ion-text>
            </a>
          </div>
        </ion-card>

        <!-- Error Card -->
        <ion-card class="reset-card error-card" *ngIf="errorMessage && !token">
          <ion-card-content class="error-content">
            <ion-icon name="alert-circle" class="error-icon"></ion-icon>
            <h2 class="error-title">Invalid Reset Link</h2>
            <p class="error-message-text">{{ errorMessage }}</p>
            <ion-button 
              expand="block" 
              (click)="goBackToLogin()"
              class="reset-button">
              Request New Reset Link
            </ion-button>
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>
</div>
